<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Odin AI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Fonts: Modern & Subtle Norse Touch -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;400&family=EB+Garamond:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-grad1: #f5f7fa;
      --bg-grad2: #e5e9f2;
      --card-bg: #fff;
      --card-border: #eee;
      --shadow: 0 8px 40px 0 #6e83a221, 0 1.5px 20px #26282a0a;
      --brand-gold: #b39c4d;
      --brand-blue: #29354d;
      --brand-gray: #e8ebf3;
      --msg-gold-bg: #fffcee;
      --msg-gold-border: #b39c4d88;
      --text-main: #15161a;
      --text-soft: #3b3e47;
      --rune-fade: #cad0e3;
    }
    body {
      background: radial-gradient(circle, var(--bg-grad1) 0%, var(--bg-grad2) 100%);
      min-height: 100vh;
      margin: 0;
      font-family: 'Montserrat', 'EB Garamond', serif;
      color: var(--text-main);
      overflow-x: hidden;
    }
    .odin-root {
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      width: 100vw;
      justify-content: flex-start;
    }
    /* Main Card */
    .odin-card {
      position: relative;
      margin: 54px 0 42px 0;
      background: var(--card-bg);
      border-radius: 26px;
      box-shadow: var(--shadow);
      border: 1.5px solid var(--card-border);
      max-width: 440px;
      width: 95vw;
      min-width: 300px;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      padding: 0 0 22px 0;
      z-index: 10;
      overflow: visible;
      transition: box-shadow .25s;
    }
    @media (min-width: 700px) {
      .odin-card {
        max-width: 590px;
      }
    }
    /* Logo */
    .odin-logo-wrap {
      position: absolute;
      top: -58px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 12;
    }
    .odin-logo-img {
      width: 90px;
      height: 90px;
      border-radius: 50%;
      background: #1b1b1b;
      box-shadow: 0 6px 22px #b39c4d33, 0 1px 0 #b39c4d55;
      border: 4px solid #fff;
      object-fit: contain;
      transition: box-shadow .22s, filter .22s;
      cursor: pointer;
    }
    .odin-logo-img:hover {
      box-shadow: 0 2px 40px 0 #b39c4dcc, 0 1px 0 #b39c4d88;
      filter: brightness(1.12) drop-shadow(0 0 16px #b39c4d66);
    }
    /* Music player vertical */
    .odin-music-float {
      position: absolute;
      top: 12px;
      right: 26px;
      z-index: 13;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 7px;
    }
    .odin-music-btn {
      background: none;
      border: none;
      font-size: 1.6em;
      cursor: pointer;
      transition: color .15s;
      color: var(--brand-gold);
      margin-bottom: 2px;
      outline: none;
    }
    .odin-music-btn.active, .odin-music-btn:focus {
      color: #29354d;
      text-shadow: 0 0 6px #b39c4d88;
    }
    .odin-music-slider {
      writing-mode: bt-lr; /* vertical */
      width: 6px;
      height: 64px;
      accent-color: var(--brand-gold);
      border-radius: 8px;
      background: var(--brand-gold);
      margin: 0 auto;
    }
    /* Runes + header */
    .odin-header-runes {
      text-align: center;
      font-family: 'EB Garamond', serif;
      font-size: 2.05em;
      letter-spacing: 0.7em;
      color: var(--rune-fade);
      font-weight: 600;
      padding-top: 44px;
      padding-bottom: 6px;
      user-select: none;
      pointer-events: none;
      width: 100%;
    }
    /* ASK ODIN Title */
    .odin-title-wrap {
      text-align: center;
      margin-top: 46px;
    }
    .odin-title {
      font-family: 'Montserrat', sans-serif;
      font-size: 2.35em;
      font-weight: 900;
      letter-spacing: .09em;
      color: var(--brand-blue);
      display: flex;
      justify-content: center;
      align-items: flex-end;
      gap: 2px;
      margin-bottom: 7px;
      user-select: none;
    }
    .odin-title .odin-o {
      transition: color .22s;
      color: var(--brand-gold);
      font-family: 'Montserrat', 'EB Garamond', serif;
      font-size: 1.13em;
      margin: 0 0.11em 0 0.11em;
      letter-spacing: 0.02em;
      cursor: pointer;
      font-weight: 900;
      position: relative;
    }
    .odin-title .odin-o.rune-hover::after {
      content: "ᛟ";
      position: absolute;
      left: 0; right: 0; top: -2px; bottom: 0;
      color: var(--brand-gold);
      font-size: 1.12em;
      font-family: 'EB Garamond', serif;
      opacity: 0.98;
      font-weight: 900;
      animation: runeSpin .6s linear;
      z-index: 1;
    }
    .odin-title .odin-o.rune-hover { color: transparent;}
    @keyframes runeSpin {
      0% { transform: rotateY(0);}
      60% { transform: rotateY(180deg);}
      100%{ transform: rotateY(360deg);}
    }
    .odin-underline-arrow {
      width: 220px;
      margin: 0 auto 3px auto;
      height: 24px;
    }
    .odin-tagline {
      font-family: 'EB Garamond', serif;
      color: #6d7180;
      font-size: 1.13em;
      font-weight: 400;
      margin-bottom: 10px;
      margin-top: 4px;
      letter-spacing: .03em;
      user-select: none;
    }
    /* Chat Loader */
    .odin-loader-outer {
      margin: 16px 0 10px 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      animation: fadeIn .6s;
    }
    @keyframes fadeIn { from {opacity:0;} to {opacity:1;}}
    .odin-loader-wrap {
      display: flex;
      align-items: center;
      gap: 0;
      padding: 4px 0;
      min-height: 44px;
    }
    .odin-loader-rune {
      font-size: 2.8em;
      color: var(--brand-gold);
      text-shadow: 0 1.5px 0 #fff, 0 0 11px #b39c4d33;
      font-family: 'EB Garamond', serif;
      font-weight: 900;
      letter-spacing: .03em;
      margin: 0 1.5px 0 0;
      opacity: 0.97;
      animation: runeGlow .9s infinite alternate;
      transition: color .2s;
      user-select: none;
    }
    @keyframes runeGlow {
      from {text-shadow: 0 1.5px 0 #fff, 0 0 4px #b39c4d77;}
      to {text-shadow: 0 4px 0 #fff, 0 0 22px #b39c4dcc;}
    }
    .odin-loader-text {
      color: #6d7180;
      font-family: 'Montserrat', serif;
      font-size: 1.04em;
      margin-left: 8px;
      letter-spacing: .01em;
      opacity: 0.94;
      font-weight: 600;
    }
    /* Chat */
    .odin-chat-wrap {
      max-height: 310px;
      min-height: 80px;
      overflow-y: auto;
      background: #f8f8f7;
      border-radius: 14px;
      box-shadow: 0 1px 7px #b39c4d08;
      margin: 7px 24px 0 24px;
      padding: 12px 19px 15px 17px;
      border: 1.5px solid #e4e4e2;
      font-size: 1.09em;
      font-family: 'EB Garamond', serif;
      color: var(--text-soft);
      transition: box-shadow .22s;
      min-width: 220px;
      word-break: break-word;
      overflow-wrap: anywhere;
    }
    @media (min-width: 500px) {
      .odin-chat-wrap { max-height: 440px; font-size: 1.17em; }
    }
    @media (min-width: 900px) {
      .odin-chat-wrap { max-width: 650px; min-width: 340px; font-size: 1.23em;}
      .odin-card { max-width: 700px;}
    }
    /* Chat message styles */
    .odin-msg.user {
      font-family: 'Montserrat', sans-serif;
      font-weight: 700;
      color: var(--brand-blue);
      background: linear-gradient(90deg,#e9ecfa 50%,#fafbfc 100%);
      border-left: 4px solid var(--brand-blue);
      border-radius: 6px;
      margin: 13px 0 7px 0;
      padding: 5px 0 5px 9px;
      font-size: 1.04em;
    }
    .odin-msg.odin {
      margin: 6px 0 13px 0;
      padding: 10px 7px 10px 12px;
      font-family: 'EB Garamond', serif;
      background: var(--msg-gold-bg);
      border-left: 4px solid var(--msg-gold-border);
      border-radius: 8px;
      color: var(--text-main);
      font-size: 1.09em;
      box-shadow: 0 2px 11px #e5ce7e13;
      line-height: 1.52;
    }
    .odin-msg strong {
      color: var(--brand-blue);
      font-weight: 900;
      letter-spacing: .03em;
      font-family: 'Montserrat', sans-serif;
      font-size: 1.01em;
    }
    .odin-msg em {
      color: var(--brand-gold);
      font-style: normal;
      font-weight: 700;
    }
    .odin-msg .gold, .odin-msg .gold-bold {
      color: var(--brand-gold);
      font-family: 'Montserrat',sans-serif;
      font-weight: 900;
      letter-spacing: .02em;
    }
    .odin-msg .blue {
      color: #3e51b8;
      font-family: 'Montserrat',sans-serif;
      font-weight: 800;
    }
    .odin-msg ul {
      margin-left: 0;
      padding-left: 20px;
    }
    .odin-msg li {
      margin-bottom: 4px;
      padding-left: 0;
      color: #393b43;
      font-size: 1em;
    }
    /* Input row */
    .odin-input-row {
      display: flex;
      align-items: center;
      margin: 16px 24px 2px 24px;
      gap: 10px;
    }
    .odin-input-box {
      flex: 1;
      font-size: 1.11em;
      border-radius: 10px;
      border: 1.5px solid #c5c5ce;
      padding: 10px 15px 10px 13px;
      font-family: 'Montserrat',sans-serif;
      color: var(--text-main);
      background: #fff;
      font-weight: 400;
      outline: none;
      transition: border-color .18s;
    }
    .odin-input-box:focus {
      border-color: var(--brand-gold);
      background: #fefbe3;
    }
    .odin-send-btn {
      background: linear-gradient(135deg, #253559 65%, #788ab9 100%);
      color: #fff;
      border: none;
      border-radius: 9px;
      font-family: 'Montserrat',sans-serif;
      font-weight: 800;
      letter-spacing: .03em;
      font-size: 1.03em;
      padding: 11px 27px;
      box-shadow: 0 3px 13px #25355929;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: background .18s;
    }
    .odin-send-btn:hover {
      background: linear-gradient(120deg, #384770 60%, #9ba2c7 100%);
    }
    /* Powered by */
    .odin-powered {
      text-align: center;
      font-size: 1.04em;
      color: #b9bbbe;
      margin: 13px auto 0 auto;
      font-family: 'Montserrat',sans-serif;
      font-weight: 600;
      letter-spacing: .02em;
    }
    .odin-powered span {
      color: #fff;
      background: linear-gradient(90deg,#b39c4d 20%,#dfc87e 80%);
      padding: 0 11px 1.5px 11px;
      border-radius: 9px;
      font-weight: 700;
      font-size: 1.04em;
      margin-left: 7px;
      box-shadow: 0 2px 6px #b39c4d21;
    }
    /* Mobile tweaks */
    @media (max-width: 520px) {
      .odin-card { max-width: 97vw; }
      .odin-chat-wrap, .odin-input-row { margin-left: 8px; margin-right: 8px;}
      .odin-logo-img { width: 64px; height: 64px;}
      .odin-title { font-size: 1.37em;}
    }
  </style>
</head>
<body>
<div class="odin-root">
  <div class="odin-card">
    <!-- Odin Logo, centered, glowing on hover -->
    <div class="odin-logo-wrap">
      <img src="https://cdn.shopify.com/s/files/1/0620/9958/7203/files/55cc97d6-4989-41cc-aa0c-67b94a56f29f.png?v=1751060831" class="odin-logo-img" id="odinLogo" alt="Odin logo" />
    </div>
    <!-- Vertical music player, floating upper right -->
    <div class="odin-music-float">
      <button class="odin-music-btn" id="odinMusicPlay" aria-label="Play/pause meditation music">
        <span id="odin-music-icon">🎵</span>
      </button>
      <input type="range" min="0" max="1" step="0.01" value="0.22" class="odin-music-slider" id="odinMusicVolume"
        aria-label="Volume"/>
    </div>
    <!-- Runes Header -->
    <div class="odin-header-runes">
      ᛈ ᚱ ᛏ ᚺ ᚠ ᚱ ᚺ ᛗ ᚲ ᛉ ᚱ ᛟ ᛗ ᚾ ᛟ ᚱ
    </div>
    <!-- Header -->
    <div class="odin-title-wrap">
      <div class="odin-title" id="odinTitle">
        ASK <span class="odin-o" id="odinO">O</span>DIN
      </div>
      <div class="odin-underline-arrow">
        <svg viewBox="0 0 220 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 8h196" stroke="#b39c4d" stroke-width="3.5" stroke-linecap="round"/>
          <polygon points="206,8 220,8 212,2 212,14" fill="#b39c4d"/>
        </svg>
      </div>
      <div class="odin-tagline">
        Wisdom, legacy, and Norse myth for the modern world
      </div>
    </div>
    <!-- Chat loader (animated runes + text), hidden until loading -->
    <div class="odin-loader-outer" id="odinLoader" style="display: none;">
      <div class="odin-loader-wrap">
        <span class="odin-loader-rune" id="odinRune">ᛗ</span>
        <span class="odin-loader-text" id="odinLoaderText">Accessing the Well of Wisdom…</span>
      </div>
    </div>
    <!-- Chat area -->
    <div class="odin-chat-wrap" id="odinChat"></div>
    <!-- Input row -->
    <div class="odin-input-row">
      <input id="odinInput" type="text" class="odin-input-box" placeholder="Ask your question…" autocomplete="off"
        onkeydown="if(event.key==='Enter'){sendOdinMsg();}" />
      <button class="odin-send-btn" onclick="sendOdinMsg()" id="odinSendBtn">
        <svg width="21" height="21" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.5h12M10.5 3l8 7.5-8 7.5" stroke="#fff" stroke-width="2.3" stroke-linecap="round" stroke-linejoin="round"/></svg>
        SEND
      </button>
    </div>
    <!-- Powered by -->
    <div class="odin-powered">Powered by <span>Valhalla’s Edge</span></div>
  </div>
</div>
<!-- Meditation music (royalty free) -->
<audio id="odinMusic" loop preload="auto">
  <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_115b9e2c82.mp3" type="audio/mpeg">
  <!-- Optionally add your own source! -->
</audio>
<script>
  // O hover: turn to rune
  const odinO = document.getElementById('odinO');
  odinO.addEventListener('mouseenter', () => odinO.classList.add('rune-hover'));
  odinO.addEventListener('mouseleave', () => odinO.classList.remove('rune-hover'));
  // Odin logo hover: gold-glow
  document.getElementById('odinLogo').addEventListener('mouseenter', function() {
    this.style.boxShadow = "0 2px 44px 0 #b39c4dcc, 0 1px 0 #b39c4d88";
    this.style.filter = "brightness(1.11) drop-shadow(0 0 22px #b39c4d66)";
  });
  document.getElementById('odinLogo').addEventListener('mouseleave', function() {
    this.style.boxShadow = "0 6px 22px #b39c4d33, 0 1px 0 #b39c4d55";
    this.style.filter = "";
  });

  // Music controls
  const odinMusic = document.getElementById('odinMusic');
  const odinMusicPlay = document.getElementById('odinMusicPlay');
  const odinMusicIcon = document.getElementById('odin-music-icon');
  const odinMusicVolume = document.getElementById('odinMusicVolume');
  let odinMusicPlaying = false;
  odinMusicPlay.addEventListener('click', function() {
    if (!odinMusicPlaying) {
      odinMusic.volume = odinMusicVolume.value;
      odinMusic.play();
      odinMusicPlaying = true;
      odinMusicIcon.textContent = "🔊";
      odinMusicPlay.classList.add("active");
    } else {
      odinMusic.pause();
      odinMusicPlaying = false;
      odinMusicIcon.textContent = "🎵";
      odinMusicPlay.classList.remove("active");
    }
  });
  odinMusicVolume.addEventListener('input', function() {
    odinMusic.volume = this.value;
  });

  // Loader (Well of Wisdom animated runes)
  const runes = ['ᛗ','ᚱ','ᛟ','ᚺ','ᛉ','ᛈ','ᚹ','ᚺ','ᚲ','ᛏ','ᛞ'];
  let runeIndex = 0;
  let loaderInterval = null;
  function showLoader(show=true, text="Accessing the Well of Wisdom…") {
    const loader = document.getElementById('odinLoader');
    const rune = document.getElementById('odinRune');
    const loaderText = document.getElementById('odinLoaderText');
    if (show) {
      loader.style.display = 'flex';
      loaderText.textContent = text;
      loaderInterval = setInterval(()=>{
        runeIndex = (runeIndex+1)%runes.length;
        rune.textContent = runes[runeIndex];
      }, 370);
    } else {
      loader.style.display = 'none';
      if (loaderInterval) clearInterval(loaderInterval);
    }
  }
  // Chat memory
  let lastMsg = "", isLoading=false;
  function addMsg(content, who='odin') {
    const chat = document.getElementById('odinChat');
    let html = '';
    if (who === 'user') {
      html = `<div class="odin-msg user">You: ${content}</div>`;
    } else if (who === 'odin') {
      html = `<div class="odin-msg odin">${content}</div>`;
    }
    chat.innerHTML += html;
    chat.scrollTop = chat.scrollHeight;
  }
  // Send message (frontend/backend logic)
  async function sendOdinMsg() {
    const input = document.getElementById('odinInput');
    const txt = input.value.trim();
    if (!txt || isLoading) return;
    addMsg(txt, 'user');
    input.value = "";
    isLoading = true;
    showLoader(true);
    try {
      const res = await fetch('/api/chat', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({message: txt, threadId: null})
      });
      const data = await res.json();
      showLoader(false);
      if (data.reply) addMsg(data.reply, 'odin');
      else addMsg("Odin is silent.", 'odin');
    } catch (e) {
      showLoader(false);
      addMsg("(Network error: "+e.message+")",'odin');
    }
    isLoading = false;
  }
  // Autofocus input on load
  window.onload = function() {
    document.getElementById('odinInput').focus();
  };
</script>
</body>
</html>
